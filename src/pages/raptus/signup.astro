---
import Base from '../../layouts/Base.astro';
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
---
<Base title="Raptus — Get Early Access" description="Sign up for exclusive behind-the-scenes content and early access to Raptus." ogImage={`https://horizonlinefilms.com${base}/images/raptus-poster.jpg`}>
<style>
  .signup-hero { position: relative; min-height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden; padding: 120px 24px 80px; }
  .signup-hero::before { content: ''; position: absolute; inset: 0; background: url('/images/hero-bg.jpg') center/cover; opacity: 0.2; }
  .signup-hero::after { content: ''; position: absolute; inset: 0; background: linear-gradient(180deg, rgba(10,9,8,0.9) 0%, rgba(10,9,8,0.5) 40%, rgba(10,9,8,0.95) 100%); }
  .signup-inner { position: relative; z-index: 1; max-width: 520px; margin: 0 auto; text-align: center; }
  .signup-inner h1 { font-size: clamp(2rem, 5vw, 3rem); font-weight: 200; letter-spacing: 6px; text-transform: uppercase; margin-bottom: 12px; }
  .signup-inner .tagline { font-size: 1rem; color: #999; font-weight: 300; margin-bottom: 8px; }
  .signup-inner .sub { font-size: 0.85rem; color: #666; margin-bottom: 32px; }
  .signup-form { display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px; }
  .signup-form input { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; padding: 14px 16px; font-size: 14px; color: #e5e5e5; font-family: inherit; outline: none; transition: border-color 0.3s; }
  .signup-form input:focus { border-color: #d4a574; }
  .signup-form input::placeholder { color: #555; }
  .signup-form .row { display: flex; gap: 12px; }
  .signup-form .row input { flex: 1; }
  .btn-signup { display: inline-block; width: 100%; padding: 14px; background: #d4a574; color: #0a0908; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; letter-spacing: 2px; text-transform: uppercase; cursor: pointer; transition: background 0.3s; font-family: inherit; }
  .btn-signup:hover { background: #e8c49a; }
  .privacy { font-size: 11px; color: #444; }
  .social-proof { margin-top: 40px; padding-top: 32px; border-top: 1px solid rgba(255,255,255,0.05); }
  .social-proof blockquote { font-size: 0.95rem; color: #999; font-style: italic; line-height: 1.7; margin-bottom: 8px; }
  .social-proof cite { font-size: 0.75rem; color: #555; font-style: normal; letter-spacing: 1px; }
  .cast-line { margin-top: 24px; font-size: 0.8rem; color: #555; }
  #signup-success { display: none; padding: 20px; background: rgba(212,165,116,0.1); border: 1px solid rgba(212,165,116,0.3); border-radius: 8px; }
  #signup-success h3 { color: #d4a574; font-size: 1.1rem; font-weight: 400; margin-bottom: 8px; }
  #signup-success p { color: #999; font-size: 0.9rem; }
</style>

<section class="signup-hero">
  <div class="signup-inner">
    <h1>Raptus</h1>
    <p class="tagline">She asked for therapy. He was programmed for desire.</p>
    <p class="sub">Get exclusive behind-the-scenes content, early access, and be the first to know when new films drop.</p>

    <form class="signup-form" id="signup-form">
      <div class="row">
        <input type="text" name="first_name" placeholder="First name" />
        <input type="email" name="email" placeholder="Email address" required />
      </div>
      <button type="submit" class="btn-signup">Get Access</button>
    </form>
    <p class="privacy">No spam. Unsubscribe anytime.</p>

    <div id="signup-success">
      <h3>You're in.</h3>
      <p>Check your inbox for a welcome email with exclusive content.</p>
      <p style="margin-top: 12px;"><a href="/raptus/watch" style="color: #d4a574; text-decoration: underline;">Watch Raptus now &rarr;</a></p>
    </div>

    <div class="social-proof">
      <blockquote>&ldquo;A provocative exploration of desire, consent, and what it means to be truly seen.&rdquo;</blockquote>
      <cite>— Horizon Line Film Company</cite>
      <p class="cast-line">Starring Ksenia Solo &middot; Nolan Gerard Funk &middot; Christina Cox &middot; 86 min</p>
    </div>
  </div>
</section>

<script is:inline>
  document.getElementById('signup-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;
    const data = {
      email: form.email.value,
      first_name: form.first_name.value || null,
      source: 'website',
      source_detail: new URLSearchParams(window.location.search).get('utm_source') || 'direct',
      territory: Intl.DateTimeFormat().resolvedOptions().timeZone || null,
      language: navigator.language?.slice(0, 2) || 'en'
    };
    try {
      const resp = await fetch('https://axuaxxvnbyngxupcikmi.supabase.co/rest/v1/uil_subscribers', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'apikey': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF4dWF4eHZuYnluZ3h1cGNpa21pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwODc3MjEsImV4cCI6MjA4MzY2MzcyMX0.Qyx_sehtSbnzr7NnQ0a-ziGBwABcLl9tUs6LoCk_xp0',
          'Prefer': 'return=minimal'
        },
        body: JSON.stringify(data)
      });
      if (resp.ok || resp.status === 201 || resp.status === 409) {
        form.style.display = 'none';
        document.querySelector('.privacy').style.display = 'none';
        document.getElementById('signup-success').style.display = 'block';
      }
    } catch {
      form.style.display = 'none';
      document.getElementById('signup-success').style.display = 'block';
    }
  });
</script>
</Base>
